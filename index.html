<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>AR Debugger</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <style>
      #debug-ui {
        position: fixed;
        top: 10px;
        left: 10px;
        right: 10px;
        z-index: 9999;
        background: rgba(0,0,0,0.8);
        color: #0f0;
        padding: 10px;
        font-family: monospace;
        font-size: 12px;
        border-radius: 5px;
        pointer-events: none;
      }
      /* This hides the blue loading screen */
      .a-loader-title { display: none !important; }
    </style>
  </head>
  <body>

    <div id="debug-ui">
      Status: Initializing...<br>
      WebXR Support: Checking...<br>
      HTTPS: Checking...
    </div>

    <!-- 
      loading-screen="enabled: false" removes the blue screen 
    -->
    <a-scene 
      loading-screen="enabled: false"
      webxr="requiredFeatures: hit-test, local-floor; optionalFeatures: dom-overlay; overlayElement: #debug-ui;"
      renderer="alpha: true;">
      
      <a-entity id="reticle" ar-hit-test="target: #reticle;">
        <a-ring rotation="-90 0 0" radius-inner="0.08" radius-outer="0.12" color="cyan"></a-ring>
      </a-entity>

      <a-box id="box" visible="false" scale="0.2 0.2 0.2" material="color: red;"></a-box>

      <a-entity camera></a-entity>
    </a-scene>

    <script>
      const status = document.getElementById('debug-ui');
      const scene = document.querySelector('a-scene');
      
      // 1. Check HTTPS
      const isHttps = window.location.protocol === 'https:';
      
      // 2. Check WebXR Support
      const hasWebXR = navigator.xr !== undefined;

      function updateDebug() {
        status.innerHTML = `
          HTTPS: ${isHttps ? "✅ YES" : "❌ NO (AR will fail)"}<br>
          WebXR API: ${hasWebXR ? "✅ YES" : "❌ NO (Use Chrome/Safari)"}<br>
          Mode: ${scene.is('ar-mode') ? "ACTIVE AR" : "Waiting for 'Enter AR' click..."}
        `;
      }

      setInterval(updateDebug, 500);

      // Placement Logic
      scene.addEventListener('click', () => {
        const reticle = document.getElementById('reticle');
        const box = document.getElementById('box');
        if (reticle.getAttribute('visible')) {
          box.setAttribute('position', reticle.getAttribute('position'));
          box.setAttribute('visible', 'true');
        }
      });
    </script>
  </body>
</html>
